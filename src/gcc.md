# GCC из командной строки

<!-- Что мы узнаем из этого раздела? -->
В этом разделе на простом примере мы увидим как собрать программу, используя только компилятор и командную строку.
В будущем эти знания понадобятся вам при отладке сборки на уровне логов многокомпонентных программ со сложными связями.

Здесь мы познакомимся с:
* утилитами `gcc`, `nm`, `ar`;
* способами сборки статических и разделяемых библиотек;

## Пример простой программы

Напишем программу на языке программирования Си.
Она выводит сообщение "Hello, my friend!" в стандартный поток вывода.
Несмотря на то, что ее можно оформить в виде одной функции `main`, она искусственно разделена на три файла: `main.c`, `hello.c`, `print.c`.
Первый файл содержит основную функцию `main`, которая вызывает две функции:
1) `const char* hello_message()` возвращает строку приветствия и определена в файле `hello.c`;
2) `void print(const char*)` выводит переданную в аргумент строку и определена в файле `print.c`.

С последними двумя файлами реализаций связаны заголовочные файлы, куда вынесены объявления функций.

```{note}
Расширение `.c` файла указывает, что в нем содержится исходный код, написанный на Си.
Если вы пишете программу на C++, то следует выбрать расширения `.cpp` или `.cxx`.
```


## Сборка исполняемого файла

Соберите исполняемый файл с именем `executable` одной командой `gcc -o executable main.c hello.c print.c`.
Опция `-o` требует аргумента -- имени выходного файла.
Далее следуют список файлов с исходными кодами программы.
Команду выше можно сократить, если воспользоваться подстановкой файлов в `bash`:
```
gcc -o executable *.c
```

На выходе появляется файл `executable`, которую можно запустить не по имени, но относительному пути:
```
bob@pc:~$./executable
Hello, my friend!
```


## Сборка разделяемой библиотеки

```
gcc -c -fPIC hello.c print.c
gcc -shared -o libhello_print.so *.o
gcc -o executable main.c -L$PWD -lhello_print
LD_LIBRARY_PATH=$PWD ./executable
```


## Сборка статической библиотеки

```
```


## Вопросы для самоконтроля

1. Распакуйте архив `exercise-1.1.tgz`.
1. Что выдаст `gcc`, если ей также передать файл с расширением `.h`?
  А если передать файл, функции в котором не вызываются в программе?
